# 11 Tratamento de Exceções

- 11.1 [Introdução](#111-introdução)
- 11.2 [Visão Geral do Tratamento de Exceções](#112-visão-geral-do-tratamento-de-exceções)
- 11.3 [Exemplo: DivideByZeroException](#113-exemplo-dividebyzeroexception)
- 11.4 [Hierarquia de Exceções do .NET](#114-hierarquia-de-exceções-do-net)
- 11.5 [O Bloco finally](#115-o-bloco-finally)
- 11.6
- 11.7
- 11.8

## 11.1 Introdução

Neste capítulo apresentaremos o **tratamento de exceções**.

Uma exceção é uma indicação de um problema que ocorre durante a execução de um programa.
O nome "exceção" vem do fato de quem embora um problema possa ocorrer, ele ocorre raramente.
Em muitos casos, o tratamento de uma exceção permite que um programa continue a executar como se nenhum problema tivesse sido encontrado.
Um problema mais sério pode impedir que um programa continue sua execução normal,
exigindo então que se notifique o usuário do problema e termine o programa de maneira controlada.

Os recursos apresentados neste capítulo permitem que os programadores escrevam **programas** claros, robustos e mais **tolerantes a falhas**.

## 11.2 Visão Geral do Tratamento de Exceções

O tratamento de exceção permite que o programador remova o código de tratamento de erros do "fluxo principal" de execução do programa.
Isso melhora a clareza do programa e sua capacidade de modificação.
Os programadores podem optar por tratar as exceções que escolherem.
Tal flexibilidade reduz a probabilidade de que erros sejam ignorados e, assim, aumenta a robustez do programa.

O tratamento de exceções é feito para processar **erros síncronos** (Erros que ocorrem durante o fluxo de controle normal do programa).

O tratamento de exceções não é feito para processar eventos **assíncronos**, como conclusões de operações de E/S de disco,
chegadas de mensagem na rede, cliques de mouse, pressionamentos de tecla e coisas assim.

O mecanismo de tratamento de exceções também é útil para processar problemas que ocorrem quando um programa interage com elementos de software,
como métodos, construtores, assemblies e classes.

O tratamento de exceções é destinados às situações em que o método que detecta um erro é incapaz de tratar ele.
Tal método **lança uma exceção**. Não há garantia de que existirá um **manipulador de exceções** para processar esse tipo de exceção. Se houver, a exceção será **capturada** e **tratada**.
O resultado de uma **exceção não capturada** depende de o programa estar sendo executado no modo de depuração ou no modo de execução padrão.

(*Pode ser útil pesquisar mais sobre*)

## 11.3 Exemplo: DivideByZeroException

Vamos considerar um exemplo simples de tratamento de exceções.

- Fig. 11.1: [DivideByZeroExceptionTest.cs](./Fig-11.01%20-%20DivideByZeroExceptionTest.cs)\
Fundamentos do tratamento de exceções do C#.

## 11.4 Hierarquia de Exceções do .NET

O mecanismo de tratamento de exceções permite que apenas objetos da classe **Exception** e de suas classes derivadas sejam lançados e capturados.

A classe **Exception** do espaço de nomes **System** é a classe base da hierarquia de exceções da plataforma .NET.
Duas das classes derivadas mais importantes de **Exception** são **ApplicationException** e **SystemException**.
**ApplicationException** é uma classe base que os programadores podem estender para criar tipos de dados de exceção específicos para seus aplicativos.

O CLR pode gerar exceções **SystemException** em qualquer ponto, durante a execução do programa.
Muitas dessas exceções podem ser evitadas utilizando-se uma condição correta. Elas são chamadas de **exceções de tempo de execução** e derivam da classe **SystemException**.

Uma vantagem de usar a hierarquia de classes de exceção é que um manipulador **catch**
pode capturar exceções de um tipo específico ou pode usar um tipo da classe base para
capturar exceções em uma hierarquia de tipos de exceção relacionados.

(*Pode ser útil pesquisar mais sobre*)

## 11.5 O Bloco finally

O mecanismo de tratamento de exceções do C# fornece o bloco **finally**,
que é garantidamente executado se o controle do programa entrar no bloco **try**.
O bloco **finally** é executado independentemente de o bloco **try** ser executado com êxito ou de uma exceção correr.
Essa garantia torna o bloco **finally** um local ideal para colocar código de desalocação de recursos, para recursos adquiridos e manipulados no bloco **try** correspondente.

Se aparecem um ou mais manipuladores catch após um bloco **try**, o bloco **finally** é opcional.\
Se não existe nenhum manipulador **catch** após um bloco **try**, um bloco **finally** deve aparecer imediatamente após o bloco **try**.\
Se existem manipuladores **catch** após um bloco **try**, o bloco **finally** aparecerá após o último **catch**.\
Apenas espaços em branco e comentários podem separar os blocos em uma sequência **try/catch/finally**.

- Fig. 11.2: [UsingExceptions.cs](./Fig-11.02%20-%20UsingException.cs)\
Usando blocos finally.
